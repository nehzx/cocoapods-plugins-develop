# cocoapods æ’ä»¶å¼€å‘

ä¹‹æ‰€ä»¥ä¼šå†™è¿™ç¯‡æ–‡ç« æ˜¯å› ä¸ºè¿‡ç¨‹æ¯”è¾ƒæ›²æŠ˜ã€‚è™½ç„¶æœ€åŽä¹Ÿæ²¡æœ‰ä½¿ç”¨cocoapods æ’ä»¶çš„æ–¹å¼æ¥å®žçŽ°è‡ªå·±æƒ³è¦çš„åŠŸèƒ½ã€‚ä½†æ˜¯è¿˜æ˜¯è®°å½•ä¸€ä¸‹ï¼Œç»™éœ€è¦çš„äººã€‚

### ç¬¬ä¸€æ­¥ï¼šå¼€å‘çŽ¯å¢ƒé…ç½®

å®˜æ–¹çš„æ–‡æ¡£å¾ˆç®€å• **[CocoaPods + Plugins
](https://guides.cocoapods.org/plugins/setting-up-plugins.html)** æˆ‘çŒœæµ‹å¯èƒ½æ˜¯å› ä¸ºè§‰å¾—æ¯”è¾ƒç®€å•å°±æ²¡æ€Žä¹ˆå†™ç›¸åº”çš„æ–‡æ¡£å§ã€‚ä½†æ˜¯å¯¹æ–°æ‰‹ç›¸å½“ä¸å‹å¥½ã€‚æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ä¹Ÿåœ¨æƒ³æ˜¯ä¸€ä¸ªæ–°æ‰‹ä¸éœ€è¦ï¼Œå¤§ç‰›ä¸å±‘çœ‹çš„æ–‡ç« ã€‚å°±å½“è®°å½•ä¸€ä¸‹è‡ªå·±çš„å¿ƒè·¯åŽ†ç¨‹å§ã€‚

æƒ³è¦å¥½å¥½çš„å¼€å‘ä¸“æ³¨äºŽå†™ä»£ç ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å¼€å‘çŽ¯å¢ƒæ˜¯å¿…ä¸å¯å°‘çš„ã€‚è¿™é‡Œç›´æŽ¥ç”¨ide æ¯”è¾ƒæ–¹ä¾¿è°ƒè¯•ã€‚

* ä¸‹è½½IDE

ä¸‹è½½[rubymine](https://www.jetbrains.com/ruby/download/) æˆ‘è‡ªå·±æ¯”è¾ƒæ‡’æ˜¯é€šè¿‡[TOOLBOX](https://www.jetbrains.com/toolbox-app/)å®‰è£…çš„, ä¸»è¦æ˜¯æ–¹ä¾¿ç®¡ç†ã€‚ç‰¹åˆ«æ˜¯ä½¿ç”¨Windowsè£…äº†è½¯ä»¶ä»¥åŽå¸è½½æ€»æ„Ÿè§‰æ²¡æœ‰å¸è½½å¹²å‡€ã€‚[æ¿€æ´»](https://www.nehza.com/345.html)çš„è¯å‚è€ƒå¦å¤–ä¸€ç¯‡æ–‡ç« 

* å®‰è£…ruby 

è¿™é‡Œæˆ‘ä¹Ÿä¸å†™äº†å®‰è£…ruby çš„æ–¹å¼æˆ‘è¿™é‡Œä¹Ÿè´´ä¸€ä¸ª[ðŸ”—é“¾æŽ¥](https://www.nehza.com/347.html)

* é…ç½®çŽ¯å¢ƒ

1ã€ åˆ›å»ºå·¥ä½œç›®å½•

```bash
mkdir cocoapods-plugins-develop
```

2ã€ åˆ›å»ºæ’ä»¶

```bash
# è¿›å…¥ç›®å½•
cd cocoapods-plugins-develop

# åˆ›å»ºæ’ä»¶
pod plugins create  nehza # æœ€åŽæ˜¯æ’ä»¶åç§°ã€‚
```

è¿™é‡Œåˆ›å»ºå®Œæ’ä»¶ä»¥åŽä¼šè‡ªåŠ¨å¸¦ä¸Šcocoapods çš„å‰ç¼€ã€‚

3ã€ åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ç”¨æ¥ç¼–è¯‘è°ƒè¯•

> Xcode -> New -> Project -> iOS -> App -> è¾“å…¥åç§°ç‚¹å‡»å®Œæˆ

åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ç»™ `podfile` æ–‡ä»¶

```bash
pod init
```
åœ¨`podfile`æ–‡ä»¶ä¸­æ·»åŠ æ’ä»¶ `plugin 'cocoapods-xxx'` æ·»åŠ åœ¨ `target` ä¸‹ã€‚


4ã€ æ·»åŠ ä¸€ä¸ª `Gemfile` æ–‡ä»¶ã€‚è¿™é‡Œæˆ‘å†™æˆä¸€ä¸ªè„šæœ¬ç›´æŽ¥æ‰§è¡Œå§ã€‚çœåŽ»åˆ›å»ºç„¶åŽåœ¨æ·»åŠ å†…å®¹çš„æ­¥éª¤,æŠŠä¸‹é¢çš„è„šæœ¬æ•´ä¸ªç²˜è´´åˆ°ç»ˆç«¯ä¸­æ‰§è¡Œã€‚æ‰§è¡Œè·¯å¾„åœ¨åˆ›å»ºçš„é¡¹ç›®å·¥ä½œç›®å½•ä¸­ã€‚

```bash
cat > Gemfile <<EOF
source 'https://gems.ruby-china.com' # æ›¿æ¢ä¸ºå›½å†…æº
gem 'cocoapods', path: './CocoaPods' # æœ¬åœ°cocoapods
gem 'cocoapods-xxx', path: './cocoapods-xxx' # æœ¬åœ°æ’ä»¶ä½ç½®
group :debug do
	gem 'ruby-debug-ide'
	gem 'debase'
end
EOF
```
5ã€è¿™é‡Œè¿›è¡Œè´´å›¾è®²è§£äº†ã€‚

æ‰“å¼€`RubyMine` æŒ‰ç…§å›¾ä¸Šç‚¹å‡»open æ‰“å¼€åˆ›å»ºçš„å·¥ä½œç›®å½•ã€‚ æ‰“å¼€åŽçœ‹åˆ°é‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶å¤¹å’Œä¸€ä¸ª`Gemfile`æ–‡ä»¶ã€‚
![](https://image.nehza.com/image/open-project.png)
![](https://image.nehza.com/image/project-info.png)

é…ç½®ruby çŽ¯å¢ƒã€‚ç‚¹å‡»åå¥½è®¾ç½®åˆ°å›¾ä¸Šä½ç½®ã€‚æ‰¾åˆ°rubyåˆ°çŽ¯å¢ƒç›®å½•ã€‚å®Œæˆä»¥åŽå¯ä»¥æ ¹æ®IDEæç¤ºå®‰è£…ä¾èµ–
![](https://image.nehza.com/image/ruby-env.png)

æŽ¥ä¸‹æ¥å°±æ˜¯é…ç½®å¯åŠ¨é¡¹äº†ã€‚ç‚¹å‡»ç¼–è¾‘è·³è½¬åˆ°å¦‚å›¾ã€‚
![](https://image.nehza.com/image/edit-start.png)
![](https://image.nehza.com/image/add-start.png)

æ ¹æ®ä¸Šå›¾æ“ä½œæ¥åˆ°é…ç½®ä¹Ÿæ²¡ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚

* å¦‚æžœåœ¨è¾“å…¥pod æ—¶å€™æ²¡æœ‰æç¤ºçš„è¯é‚£ä¹ˆæœ‰å¯èƒ½ä½ çš„ruby é…ç½®æ²¡æœ‰æˆåŠŸã€‚ 
* å·¥ä½œç›®å½•éœ€è¦æ›´æ”¹ä¸ºä½ demoçš„é¡¹ç›®ä¹Ÿå°±æ˜¯`podfile`æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚
![](https://image.nehza.com/image/pod-env.png)
![](https://image.nehza.com/image/start-finish.png)

æœ€åŽå°±æ˜¯è¿™é‡Œé’©ä¸Šâœ…
![](https://image.nehza.com/image/budler.png)

### ç¬¬äºŒæ­¥ï¼šæ’ä»¶å¼€å‘

cocoapods è¿™é‡Œçš„å¼€å‘åˆ†ä¸ºä¸¤ç§æ¨¡å¼ 

* hooks å·²æœ‰çš„å‘½ä»¤å¢žåŠ åŠŸèƒ½
* æ–°å¢žå‘½ä»¤æ¥æ‰©å±•æ–°åŠŸèƒ½ã€‚

æˆ‘è¿™é‡Œè´´ä¸‹æ’ä»¶ç›®å½•æ¥è¯´æ˜Žä¸€ä¸‹

```bash
â”œâ”€â”€ Gemfile  # ä¾èµ–é…ç½®ç±»ä¼¼äºŽ podfile
â”œâ”€â”€ LICENSE.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ Rakefile # æ ¡éªŒæ–‡ä»¶
â”œâ”€â”€ cocoapods-unp.gemspec # ç±»ä¼¼äºŽpodspec
â”œâ”€â”€ lib
â”‚Â Â  â”œâ”€â”€ cocoapods-unp
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ command
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ unp.rb # è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬éœ€è¦å¼€å‘çš„å‘½ä»¤ runæ–¹æ³•å°±æ˜¯æ‰§è¡Œçš„ä½ç½®ã€‚
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ command.rb
â”‚Â Â  â”‚Â Â  â””â”€â”€ gem_version.rb
â”‚Â Â  â”œâ”€â”€ cocoapods-unp.rb
â”‚Â Â  â”œâ”€â”€ cocoapods_plugin.rb # è¿™é‡Œæ˜¯åŠ è½½æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚å¯ä»¥åœ¨è¿™é‡Œhooks å·²æœ‰çš„å‘½ä»¤åŠæ–¹æ³•
â”‚Â Â  â””â”€â”€ provider_hook.rb
â””â”€â”€ spec
    â”œâ”€â”€ command
    â”‚Â Â  â””â”€â”€ unp_spec.rb
    â””â”€â”€ spec_helper.rb
```


### ç¬¬ä¸‰æ­¥ï¼šæ’ä»¶ç¼–è¯‘åŠå®‰è£…


æœ€åŽåè€Œæ˜¯æœ€æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡çš„ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯ä¸¤æ¡å‘½ä»¤

**ç¼–è¯‘**

```bash
gem build cocoapods-xxx.gemspec
```


**å®‰è£…**


```bash
gem install cocoapods-xxxx-0.0.1.gem

```